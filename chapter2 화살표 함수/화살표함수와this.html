<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .opening {
            background-color: red;
        }

    </style>
</head>
<body>

    <div class="box open">
        This is a box
    </div>

    <script>
        // 화살표 함수 내부에서 this 키워드를 사용할 때는 일반함수와 다르게 동작하므로 주의해야 한다.
        // 화살표 함수를 사용할 때 this 키워드는 상위 스코프에서 상속된다.

        // const box = document.querySelector(".box")

        // box.addEventListener('click', function(){
        //     this.classList.toggle('opening');
        //     setTimeout(function(){
        //         this.classList.toggle('opening');
        //     }, 500);
        // });
        
        // Uncaught TypeError: Cannot read properties of undefined (reading 'toggle')
        // 이 코드의 문제는 this가 const box에 할당되었지만 setTimeout 내부의 두 번째 this는 Window 객체로 설정되어 오류가 발생한다는 것

        const box = document.querySelector(".box")

        box.addEventListener('click', function(){
            this.classList.toggle('opening');
            setTimeout(()=>{
                this.classList.toggle('opening');
            }, 500);
        });

        // 이렇게 고치면 두 번째 this는 부모로부터 상속되며 const box 로 설정된다.
        
    </script>
</body>
</html>